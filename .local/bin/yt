#!/bin/sh
case "$1" in
    video) cmd="yt-dlp -i -o ~/Videos/Watchlist/%(title)s_%(epoch)s.%(ext)s" ;;
    audio) cmd="yt-dlp --embed-metadata -x -f bestaudio -o ~/Music/%(title)s.%(ext)s" ;;
    thumb) cmd="yt-dlp --skip-download --write-thumbnail -o ~/Pictures/%(title)s.%(ext)s" ;;
    image) cmd="gallery-dl --cookies-from-browser firefox -d ~/Pictures" ;;
    dwnld) [ -z "$3" ] && cmd="aria2c --dir=${HOME}/Videos/Watchlist" || cmd="$3" ;;
esac
url=${2:-$(xclip -o)}
[ "$1" = dwnld ] && name="$(echo "$url" | sed 's:.*/::; s/\?.*//')" || name="${url##*/}"
notify-send -i "$PIX/dlpending.svg" "Queuing download" "$name"
tsp -D "$(tsp $cmd "$url")" notify-send -i "$PIX/dlcomplete.svg" "Download complete" "$name"
