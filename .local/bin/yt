#!/bin/sh

url="$(xclip -o)"
[ -z "$url" ] && exit
name="$(basename "$url")"
notify-send -i "$HOME/.local/share/icons/dunst/dlpending.svg" "Queuing download" "$name"

case "$1" in
    video)
        dlcmd="yt-dlp --embed-metadata -ic"
        ;;
    audio)
        dlcmd="yt-dlp --ignore-config --embed-metadata -x -f bestaudio"
        ;;
    thumb)
        dlcmd="yt-dlp --skip-download --write-thumbnail"
        ;;
    pix)
        dlcmd="gallery-dl"
        ;;
esac

idnum="$(tsp $dlcmd "$url")"
tsp -D "$idnum" notify-send -i "$HOME/.local/share/icons/dunst/dlcomplete.svg" "Download complete" "$name"
