#!/bin/sh
cmd=$1
shift
while [ "$#" -gt 1 ]; do
    files_to_move="$files_to_move $1"
    shift
done
dest_dir=$1

for file_to_move in $files_to_move; do
    name_of_file=$(basename "$file_to_move")
    name_before_extension="${name_of_file%.*}"
    extension="${name_of_file##*.}"
    newfile="$name_of_file"
    counter=1
    while [ -f "$dest_dir/$newfile" ]; do
        newfile="${name_before_extension}($counter).$extension"
        counter=$((counter + 1))
    done
    "$cmd" "$file_to_move" "$dest_dir/$newfile"
done
