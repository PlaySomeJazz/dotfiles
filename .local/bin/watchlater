#!/bin/sh

source_dir="/mnt/media_files/torrents"
watchlist="$HOME/Videos/Watchlist"
music="$HOME/Music"
export music

# Move videos to watchlist
find "$source_dir" -type f \( -iname "*.mp4" -o -iname "*.mkv" \) -exec mv {} "$watchlist" \;

# Move directories containing audio into Music
find "$source_dir" -mindepth 1 -depth -type d -exec sh -c 'if find "$0" -type f -iname "*.mp3" -o -iname "*.m4b" -o -iname "*.flac" -o -iname "*.m4a" -o -iname "*.opus"; then mv "$0" "$music"; fi' {} \;

# Delete directories with no files of these types
find "$source_dir" -mindepth 1 -depth -type d -exec sh -c 'if find "$0" -type f -iname "*.pdf" -o -iname "*.djvu" -o -iname "*.epub" -o -iname "*.mobi" -o -iname "*.zip" -o -iname "*.rar" -print -quit; then :; else rm -rf "$0"; fi' {} \;

# Delete empty directories
#find "$source_dir" -mindepth 1 -type d -empty -delete
