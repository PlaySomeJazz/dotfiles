#!/bin/sh

source_dir="/mnt/media_files/torrents"
watchlist="$HOME/Videos/Watchlist"
music="$HOME/Music"
export music

# Move videos to Watchlater
find "$source_dir" -type f \( -iname "*.mp4" -o -iname "*.mkv" \) -exec mv {} "$watchlist" \;

# Move directories containing audio into Music
find "$source_dir" -mindepth 1 -depth -type d -exec sh -c 'if find "$0" -type f -iname "*.{mp3,m4b,flac,m4a,opus,wav}" ; then mv "$0" "$music"; fi' {} \;

# Delete directories with no files of these types
find "$source_dir" -mindepth 1 -depth -type d -exec sh -c 'if find "$0" -type f -iname "*.{pdf,djvu,epub,mobi,zip,rar}" ; then rm "$0"; fi' {} \;

# Delete empty directories
find "$source_dir" -mindepth 1 -type d -empty -delete
