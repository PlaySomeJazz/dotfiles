#!/bin/sh

T='
https://ngosang.github.io/trackerslist/trackers_best.txt
https://cf.trackerslist.com/best.txt
'

if ! pidof transmission-daemon >/dev/null; then
	transmission-daemon
	notify-send -i $PIX/transmission.svg Starting...
	sleep 3
	transmission-remote --blocklist-update
fi

if ! test -s /tmp/tr; then
	curl -sLZ $T | sort -u >/tmp/tr
fi

for i do
	case $i in
	magnet:\?*)
		while read tr; do
			i="${i}&tr=${tr}"
		done </tmp/tr
	esac
	n=`transmission-remote -a "$i"`
	n=${n#*\"name\":\"} n=${n%\"*}
	notify-send -i $PIX/transmission.svg Added "$n"
	pkill -12 status
done
